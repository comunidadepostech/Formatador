<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Formatador de Decupagens com IA</title>
<link rel="stylesheet" href="style.css" />
</head>
<body>
    <div id="app">
        <h1>Formatador de Decupagens (com IA OpenAI)</h1>

        <input type="text" id="project-name-input" placeholder="Nome do Projeto" />
        <input type="text" id="API_KEY" placeholder="Digite o seu API key" />

        <textarea id="global-prompt-textarea" placeholder="Instruções gerais para a IA...">Você agora deve auxiliar na formatação de textos de decupagem para o formato aceito na ferramenta Markerbox. Você receberá textos de decupagem que contém minutagens de entrada e saída que podem conter comentários relativos à elas. Quando houver uma minutagem incompleta (somente entrada/saída), você deve adicionar a minutagem faltante (entrada ou saida) com uma pequena diferença de até 10 segundos para que o Markerbox entenda e possa criar a marcação corretamente (estas minutagens incompletas geralmente vêm com um comentário como "início/encerramento do vídeo/gravação").
            Um exemplo de texto original de decupagem:

            "2GETT - IA para Negócios
            Aula 1 / Vídeo 2 - Como a IA pode te ajudar na visão de futuro e insights
            Vídeo começa em: 22s (Sejam bem-vindos e bem-vindas)
            *Substituir o slide de 19min53s à 21min15s & de 21min25s à 21min32s pelo *slide 31* do PPTx da Aula 1: Aula 1 - COMO A IA PODE TE AJUDAR NA VISÃO DE FUTURO E INSIGHTS_revisado.pptx
            27min47s (muito mais facilitados ali pro seu processo) ~ 29min25s (nesse vídeo a gente entendeu)
            Vídeo termina em: 29min48s (te vejo no próximo vídeo)"

            Como este exemplo deve ficar após formatado para o Markerbox:
            00:22	00:25	Início do vídeo
            19:53	21:15	Substituir slide
            21:25	21:32	Substituir slide
            27:47	29:25	(muito mais facilitados ali pro seu processo)~(nesse vídeo a gente entendeu)
            29:48	29:52	Final do vídeo	(te vejo no próximo vídeo)

            ATENÇÃO: Você não deve escrever "[Tab]", mas sim adicionar um espaço especial utilizando o recurso de tabulação do teclado
            Você deve evitar de realizar quebras de linha indevidas, pois isso faz com que o Markerbox ignore os valores desejados. Isso significa realizar quebras de linha somente quando for iniciar uma nova marcação de minutagem.
            Você deve ser sensível aos valores de tempo e marcações de texto do tempo orginal, julgando quando deve unir linhas ou criar marcações de entrada/saída conforme a instrução. Isso significa que, no exemplo de input original abaixo:
            "00:14 (Introdução)
            01:42 (Corte)
            01:53 (Retorna em: "Então, bem-vindos a aula de Desenvolvimento...")
            14:06 (Corte)
            14:48 (Retorna em: "Hoje T.I está no centro do negócio...")"
            Você deve levar em consideração que o "00:14  (Introdução)" deve ter o valor de entrada de "00:00", uma vez que todo vídeo inicia do zero, também que em "01:42 (corte)" há um corte no vídeo sem o valor exato de entada/saída na mesma linha, mas pela lógica que o corte deve ser retomado, podemos encontrar o valor de saída na linha "01:53 (Retorna...". Você deve levar essas coisas em consideração para que JAMAIS gere minutagens erradas como no exemplo:
            "00:13	00:14	(Introdução)
            00:14	01:42	(Corte)
            01:42	01:53	(Retorna em: "Então, bem-vindos a aula de Desenvolvimento...")" - pois aqui o erro está em criar uma marcação de "00:14" à "01:42" que não deveria existir
            Realize uma verificação de lógica e reflita após a formatação antes de retornar sua resposta.

            Quando houverem casos em que há somente um valor de entrada seguido de "(Corte)" ou "Corte" na mesma linha ou se houver um valor de entrada e um valor de saída seguidos apenas de "(Corte)" e, ao mesmo tempo, na linha logo abaixo também só houver um valor de entrada seguido de "Retoma...", você deve juntar o valor de entrada da segunda linha à primeira linha como valor final, eliminando o texto "(Corte)" e fromatando com os espaços de Tab como as demais formatações.
            Aqui um exemplo do texto ANTES da formatação com entradas e saídas ERRADAS:
            "03:31 (Corte)
            03:39 (Retorna em: "E a arquitetura ela é estratégia...")"

            Aqui como este texto deve ficar após a formatação:
            "03:31	03:39	(Retoma em: "E a arquitetura ela é estratégia...")"

            Aqui outro exemplo do texto ANTES da formatação com entradas e saídas ERRADAS:
            "00:00 - 00:18 (Corte)
            00:19 (Retorna em: "KPIs que importam...")"

            Aqui como este texto deve ficar após a formatação:
            "00:18	00:19	(Retorna em: "KPIs que importam...")"
            Quando houverem linhas que iniciam com um valor de tempo menor do que o último valor de tempo linhas acima, isso significa que esta é uma decupagem com mais de uma PARTE. Um exemplo de como identificar decupagens com mais de uma PARTE:
            "00:55	00:56	(Introdução)
            04:12	04:16	(Corte e finaliza - O Riverside bugou para mim durante a gravação, então finalizamos ela
            e iniciamos novamente na PARTE 2)
            00:00	00:18	(Corte)
            00:19	00:20	(Retorna em: "KPIs que importam...")
            26:10	26:11	(Finaliza)"

            Neste exemplo acima, o valor "00:00" na terceira linha é menor que "04:16", que deveria ser o valor final mais alto das linahs anteriores.
            Quando isso acontecer, todos os valores de entrada e saída da linha identificada como o início de uma nova PARTE devem ser recalculados de forma a dar continuidade na decupagem como se fosse um único vídeo, a partir do último valor de tempo mais alto. Utilizando ainda o exemplo acima, é assim que o texto deveria ficar após formatado:
            "00:54	00:55	(INTRODUÇÃO)
            04:12	04:16	(Corte e finaliza - O Riverside bugou para mim durante a gravação, então finalizamos ela
            e iniciamos novamente na PARTE 2)
            04:16	04:34	(Corte)
            04:35	04:36	(Retorna em: "KPIs que importam...")
            30:26	30:27	(finaliza)"</textarea>

        <div id="aulas-container"></div>

        <button id="add-aula-btn">Adicionar Aula</button>
        <button id="export-all-btn">Exportar Tudo</button>
        <button id="save-local-btn">Salvar no Navegador</button>
        <button id="download-project-btn">Baixar Projeto (.json)</button>
        <button id="upload-project-btn">Carregar Projeto (.json)</button>
        <input type="file" id="project-file-input" style="display:none" accept=".json" />

    </div>

    <!-- Template de Aula -->
    <template id="aula-template">
        <div class="aula-container">
            <h3 class="aula-title">Aula X</h3>
            <label>
                <input type="checkbox" class="multipart-checkbox" />
                Vídeo em várias partes
            </label>
            <div class="inputs-wrapper"></div>

            <button class="add-part-btn" style="display:none;">Adicionar parte</button>
            <button class="format-btn">Formatar</button>
            <button class="export-individual-btn">Exportar Aula</button>
            <button class="remove-aula-btn">Remover Aula</button>

            <textarea class="output-textarea" placeholder="O resultado formatado aparecerá aqui..." readonly></textarea>
            <button class="copy-btn" style="display:none;">Copiar</button>
        </div>
    </template>

    <script type="module" src="script.js"></script>
</body>
</html>
